<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBMAX Rebeca - Painel Admin</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f0f2f5; }
        .header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 1.8em; }
        .header h1 span { color: #e94560; }
        .btn-logout { background: #e94560; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; }
        .container { display: flex; min-height: calc(100vh - 70px); }
        .sidebar { width: 260px; background: #1a1a2e; padding: 20px 0; overflow-y: auto; }
        .menu-item { padding: 12px 20px; color: #ccc; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: all 0.3s; border-left: 3px solid transparent; font-size: 0.95em; }
        .menu-item:hover, .menu-item.active { background: rgba(233,69,96,0.2); color: white; border-left-color: #e94560; }
        .menu-section { padding: 15px 20px 5px; color: #666; font-size: 0.75em; text-transform: uppercase; letter-spacing: 1px; }
        .main-content { flex: 1; padding: 25px; overflow-y: auto; }
        .page { display: none; }
        .page.active { display: block; }
        .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        .card-icon { font-size: 2em; margin-bottom: 8px; }
        .card h3 { color: #666; font-size: 0.85em; margin-bottom: 5px; }
        .card .value { font-size: 1.8em; font-weight: bold; color: #1a1a2e; }
        .card.green { border-left: 4px solid #27ae60; }
        .card.blue { border-left: 4px solid #3498db; }
        .card.orange { border-left: 4px solid #f39c12; }
        .card.red { border-left: 4px solid #e74c3c; }
        .card.purple { border-left: 4px solid #9b59b6; }
        .panel { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); margin-bottom: 20px; }
        .panel h2 { color: #1a1a2e; margin-bottom: 15px; font-size: 1.2em; }
        .panel-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px 12px; text-align: left; border-bottom: 1px solid #f0f2f5; font-size: 0.9em; }
        th { background: #f8f9fa; font-weight: 600; color: #666; }
        tr:hover { background: #f8f9fa; }
        .badge { padding: 4px 10px; border-radius: 15px; font-size: 0.8em; font-weight: 500; }
        .badge.green { background: #d4edda; color: #155724; }
        .badge.blue { background: #cce5ff; color: #004085; }
        .badge.yellow { background: #fff3cd; color: #856404; }
        .badge.red { background: #f8d7da; color: #721c24; }
        .badge.purple { background: #e2d9f3; color: #6f42c1; }
        .badge.orange { background: #ffe5d0; color: #d35400; }
        .btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85em; transition: all 0.3s; margin: 2px; }
        .btn-sm { padding: 5px 10px; font-size: 0.8em; }
        .btn-primary { background: #3498db; color: white; }
        .btn-success { background: #27ae60; color: white; }
        .btn-danger { background: #e74c3c; color: white; }
        .btn-warning { background: #f39c12; color: white; }
        .btn-purple { background: #9b59b6; color: white; }
        .btn:hover { opacity: 0.85; transform: translateY(-1px); }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; color: #333; font-size: 0.9em; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #3498db; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 12px; padding: 25px; width: 100%; max-width: 600px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-close { background: none; border: none; font-size: 1.5em; cursor: pointer; color: #999; }
        .search-bar { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .search-bar input, .search-bar select { flex: 1; min-width: 150px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; }
        #mapaLeaflet { height: 400px; border-radius: 10px; }
        #mapaGoogle { height: 400px; border-radius: 10px; background: #e0e0e0; }
        .chart-container { height: 300px; position: relative; }
        .ranking-item { display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #f0f2f5; }
        .ranking-pos { width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; color: white; }
        .ranking-pos.gold { background: linear-gradient(135deg, #f1c40f, #f39c12); }
        .ranking-pos.silver { background: linear-gradient(135deg, #bdc3c7, #95a5a6); }
        .ranking-pos.bronze { background: linear-gradient(135deg, #e67e22, #d35400); }
        .ranking-pos.normal { background: #666; }
        .ranking-info { flex: 1; }
        .ranking-info h4 { margin: 0; font-size: 1em; }
        .ranking-stats .valor { font-size: 1.2em; font-weight: bold; color: #27ae60; }
        .pico-container { display: flex; align-items: center; margin: 5px 0; }
        .pico-bar { height: 25px; border-radius: 5px; margin: 3px 0; }
        .pico-bar.alto { background: linear-gradient(90deg, #e74c3c, #c0392b); }
        .pico-bar.medio { background: linear-gradient(90deg, #f39c12, #e67e22); }
        .pico-bar.baixo { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .hora-label { display: inline-block; width: 50px; font-size: 0.85em; color: #666; }
        .pico-value { margin-left: 10px; font-size: 0.85em; font-weight: 500; }
        .status-indicator { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; }
        .status-indicator.online { background: #27ae60; }
        .status-indicator.offline { background: #e74c3c; }
        .token-box { background: linear-gradient(135deg, #27ae60, #2ecc71); border-radius: 12px; padding: 20px; margin-top: 20px; color: white; text-align: center; }
        .token-box code { background: rgba(0,0,0,0.3); padding: 12px 20px; border-radius: 8px; font-size: 1em; display: block; margin: 10px 0; word-break: break-all; }
        .divider { border: none; border-top: 2px solid #eee; margin: 20px 0; }
        .alert { padding: 12px 15px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em; }
        .alert-success { background: #d4edda; color: #155724; }
        .alert-error { background: #f8d7da; color: #721c24; }
        .log-item { padding: 10px; border-left: 3px solid #3498db; margin-bottom: 8px; background: #f8f9fa; border-radius: 0 8px 8px 0; }
        .alerta-fraude { padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid; }
        .alerta-fraude.critico { background: #ffeaea; border-left-color: #c0392b; }
        .alerta-fraude.alto { background: #fff5f5; border-left-color: #e74c3c; }
        .alerta-fraude.medio { background: #fff8e6; border-left-color: #f39c12; }
        .alerta-fraude.baixo { background: #e8f8f5; border-left-color: #27ae60; }
        .alerta-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .alerta-motivos { font-size: 0.9em; color: #666; }
        .alerta-motivos li { margin: 3px 0; }
        .rota-info { background: #f8f9fa; padding: 15px; border-radius: 10px; margin-top: 15px; }
        .rota-info h4 { margin-bottom: 10px; }
        .rota-detalhe { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; background: #3498db; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .modo-card { padding: 20px; border: 3px solid #e0e0e0; border-radius: 12px; cursor: pointer; transition: all 0.3s; margin-bottom: 15px; }
        .modo-card:hover { border-color: #3498db; }
        .modo-card.active { border-color: #27ae60; background: #f0fff4; }
        .modo-card h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .modo-card p { color: #666; font-size: 0.9em; margin: 0; }
        .modo-icon { font-size: 2em; }
        .corrida-despacho { background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 10px; border-left: 4px solid #3498db; }
        .corrida-despacho.aguardando { border-left-color: #f39c12; }
        .corrida-despacho.aceita { border-left-color: #27ae60; }
    </style>
</head>
<body>
    <header class="header">
        <h1>UB<span>MAX</span> Rebeca</h1>
        <div style="display:flex;align-items:center;gap:20px;">
            <div style="text-align:right;"><div id="userName">Admin</div><small id="userRole" style="opacity:0.8;">Administrador</small></div>
            <button class="btn-logout" onclick="logout()">Sair</button>
        </div>
    </header>

    <div class="container">
        <nav class="sidebar">
            <div class="menu-section">Principal</div>
            <div class="menu-item active" data-page="dashboard">ğŸ“Š Dashboard</div>
            <div class="menu-item" data-page="mapa">ğŸ—ºï¸ Mapa Tempo Real</div>
            
            <div class="menu-section">OperaÃ§Ãµes</div>
            <div class="menu-item" data-page="corridas">ğŸš— Corridas</div>
            <div class="menu-item" data-page="despacho">ğŸ“¡ Despacho</div>
            <div class="menu-item" data-page="motoristas">ğŸ‘¨â€âœˆï¸ Motoristas</div>
            <div class="menu-item" data-page="clientes">ğŸ‘¥ Clientes</div>
            <div class="menu-item" data-page="rotas">ğŸ“ Calcular Rota</div>
            
            <div class="menu-section">Financeiro</div>
            <div class="menu-item" data-page="faturamento">ğŸ’° Faturamento</div>
            <div class="menu-item" data-page="ranking">ğŸ† Ranking</div>
            
            <div class="menu-section">SeguranÃ§a</div>
            <div class="menu-item" data-page="antifraude">ğŸ›¡ï¸ Anti-Fraude</div>
            <div class="menu-item" data-page="blacklist">ğŸš« Blacklist</div>
            
            <div class="menu-section">Atendimento</div>
            <div class="menu-item" data-page="reclamacoes">ğŸ“ ReclamaÃ§Ãµes</div>
            <div class="menu-item" data-page="whatsapp">ğŸ’¬ WhatsApp</div>
            
            <div class="menu-section">Sistema</div>
            <div class="menu-item" data-page="usuarios">ğŸ‘¤ UsuÃ¡rios Admin</div>
            <div class="menu-item" data-page="areas">ğŸ—ºï¸ Ãreas Cobertura</div>
            <div class="menu-item" data-page="precos">ğŸ’µ PreÃ§os</div>
            <div class="menu-item" data-page="config">âš™ï¸ ConfiguraÃ§Ãµes</div>
            <div class="menu-item" data-page="logs">ğŸ“œ Logs</div>
        </nav>

        <main class="main-content">
            <!-- DASHBOARD -->
            <div id="dashboard" class="page active">
                <h2 style="margin-bottom:20px;">ğŸ“Š Dashboard</h2>
                <div class="cards">
                    <div class="card green"><div class="card-icon">ğŸŸ¢</div><h3>Motoristas Online</h3><div class="value" id="motoristasOnline">0</div></div>
                    <div class="card blue"><div class="card-icon">ğŸš—</div><h3>Corridas Hoje</h3><div class="value" id="corridasHoje">0</div></div>
                    <div class="card orange"><div class="card-icon">â³</div><h3>Pendentes</h3><div class="value" id="corridasPendentes">0</div></div>
                    <div class="card green"><div class="card-icon">ğŸ’°</div><h3>Faturamento</h3><div class="value">R$ <span id="faturamentoHoje">0</span></div></div>
                    <div class="card red"><div class="card-icon">ğŸ›¡ï¸</div><h3>Alertas Fraude</h3><div class="value" id="alertasFraude">0</div></div>
                </div>
                <div class="panel-grid">
                    <div class="panel"><h2>ğŸ“ˆ Corridas - 7 dias</h2><div class="chart-container"><canvas id="chartCorridas"></canvas></div></div>
                    <div class="panel"><h2>â° HorÃ¡rios de Pico</h2><div id="horariosPico"></div></div>
                </div>
                <div class="panel-grid">
                    <div class="panel"><h2>ğŸ† Top 5 Motoristas</h2><div id="topMotoristas"></div></div>
                    <div class="panel"><h2>ğŸ”” Corridas Ativas</h2><table><thead><tr><th>Cliente</th><th>Motorista</th><th>Status</th><th>AÃ§Ã£o</th></tr></thead><tbody id="corridasAtivasTable"></tbody></table></div>
                </div>
            </div>

            <!-- MAPA -->
            <div id="mapa" class="page">
                <h2 style="margin-bottom:20px;">ğŸ—ºï¸ Mapa em Tempo Real</h2>
                <div class="cards">
                    <div class="card green"><h3>DisponÃ­veis</h3><div class="value" id="mapaDisponiveis">0</div></div>
                    <div class="card blue"><h3>Em Corrida</h3><div class="value" id="mapaEmCorrida">0</div></div>
                    <div class="card red"><h3>Offline</h3><div class="value" id="mapaOffline">0</div></div>
                </div>
                <div class="panel"><div id="mapaLeaflet"></div></div>
                <button class="btn btn-primary" onclick="atualizarMapa()">ğŸ”„ Atualizar</button>
            </div>

            <!-- CORRIDAS -->
            <div id="corridas" class="page">
                <h2 style="margin-bottom:20px;">ğŸš— Corridas</h2>
                <div class="search-bar">
                    <input type="text" id="buscaCorrida" placeholder="Buscar...">
                    <select id="filtroCorrida"><option value="">Todos</option><option value="pendente">Pendente</option><option value="aceita">Aceita</option><option value="em_andamento">Em Andamento</option><option value="finalizada">Finalizada</option><option value="cancelada">Cancelada</option></select>
                    <button class="btn btn-primary" onclick="carregarCorridas()">ğŸ” Buscar</button>
                </div>
                <div class="panel"><table><thead><tr><th>ID</th><th>Cliente</th><th>Origem</th><th>Destino</th><th>Valor</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead><tbody id="corridasTable"></tbody></table></div>
            </div>

            <!-- DESPACHO -->
            <div id="despacho" class="page">
                <h2 style="margin-bottom:20px;">ğŸ“¡ Central de Despacho</h2>
                <div class="cards">
                    <div class="card blue"><div class="card-icon">ğŸ“¡</div><h3>Modo Atual</h3><div class="value" id="modoDespachoAtual">-</div></div>
                    <div class="card orange"><div class="card-icon">â³</div><h3>Aguardando Aceite</h3><div class="value" id="aguardandoAceite">0</div></div>
                    <div class="card green"><div class="card-icon">âœ…</div><h3>Aceitas Hoje</h3><div class="value" id="aceitasHoje">0</div></div>
                    <div class="card purple"><div class="card-icon">ğŸ‘¨â€âœˆï¸</div><h3>Motoristas Online</h3><div class="value" id="motoristasDespacho">0</div></div>
                </div>

                <div class="panel">
                    <h2>âš™ï¸ Modo de Despacho</h2>
                    <p style="color:#666;margin-bottom:20px;">Escolha como as corridas serÃ£o enviadas aos motoristas</p>
                    
                    <div class="modo-card" id="modoBroadcast" onclick="setModoDespacho('broadcast')">
                        <h3><span class="modo-icon">ğŸ“¢</span> Broadcast (Todos)</h3>
                        <p>Envia a corrida para TODOS os motoristas disponÃ­veis. O primeiro que aceitar leva a corrida.</p>
                        <p style="margin-top:10px;"><strong>âœ… Vantagem:</strong> Mais rÃ¡pido para encontrar motorista</p>
                    </div>
                    
                    <div class="modo-card" id="modoProximo" onclick="setModoDespacho('proximo')">
                        <h3><span class="modo-icon">ğŸ“</span> Motorista Mais PrÃ³ximo</h3>
                        <p>Envia a corrida apenas para o motorista mais prÃ³ximo do cliente. Se recusar, passa para o prÃ³ximo.</p>
                        <p style="margin-top:10px;"><strong>âœ… Vantagem:</strong> Menor tempo de espera do cliente</p>
                    </div>

                    <div class="form-group" style="margin-top:20px;">
                        <label>Tempo para aceitar (segundos)</label>
                        <input type="number" id="tempoAceite" value="30" style="width:100px;">
                        <button class="btn btn-primary" onclick="salvarTempoAceite()" style="margin-left:10px;">Salvar</button>
                    </div>
                </div>

                <div class="panel">
                    <h2>ğŸš— Corridas Pendentes</h2>
                    <div id="corridasPendentesDespacho"></div>
                </div>

                <div class="panel">
                    <h2>ğŸ‘¨â€âœˆï¸ Motoristas DisponÃ­veis</h2>
                    <table>
                        <thead><tr><th>Nome</th><th>DistÃ¢ncia Centro</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead>
                        <tbody id="motoristasDespachoTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- MOTORISTAS -->
            <div id="motoristas" class="page">
                <h2 style="margin-bottom:20px;">ğŸ‘¨â€âœˆï¸ Motoristas</h2>
                <div class="search-bar">
                    <input type="text" id="buscaMotorista" placeholder="Buscar...">
                    <select id="filtroStatusMotorista"><option value="">Todos</option><option value="disponivel">DisponÃ­vel</option><option value="em_corrida">Em Corrida</option><option value="offline">Offline</option></select>
                    <button class="btn btn-primary" onclick="carregarMotoristas()">ğŸ” Buscar</button>
                    <button class="btn btn-success" onclick="abrirModalMotorista()">+ Novo</button>
                </div>
                <div class="panel"><table><thead><tr><th>Nome</th><th>WhatsApp</th><th>VeÃ­culo</th><th>Placa</th><th>Status</th><th>AvaliaÃ§Ã£o</th><th>AÃ§Ãµes</th></tr></thead><tbody id="motoristasTable"></tbody></table></div>
            </div>

            <!-- CLIENTES -->
            <div id="clientes" class="page">
                <h2 style="margin-bottom:20px;">ğŸ‘¥ Clientes</h2>
                <div class="search-bar">
                    <input type="text" id="buscaCliente" placeholder="Buscar...">
                    <button class="btn btn-primary" onclick="carregarClientes()">ğŸ” Buscar</button>
                    <button class="btn btn-success" onclick="abrirModalCliente()">+ Novo</button>
                </div>
                <div class="panel"><table><thead><tr><th>Nome</th><th>Telefone</th><th>Corridas</th><th>NÃ­vel</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead><tbody id="clientesTable"></tbody></table></div>
            </div>

            <!-- ROTAS -->
            <div id="rotas" class="page">
                <h2 style="margin-bottom:20px;">ğŸ“ Calcular Rota e PreÃ§o</h2>
                <div class="panel">
                    <h2>ğŸ—ºï¸ Simulador de Corrida</h2>
                    <div class="form-row">
                        <div class="form-group"><label>Origem</label><input type="text" id="rotaOrigem" placeholder="Ex: Rua das Flores, 123 - Osasco"></div>
                        <div class="form-group"><label>Destino</label><input type="text" id="rotaDestino" placeholder="Ex: Av. Brasil, 456 - SÃ£o Paulo"></div>
                    </div>
                    <button class="btn btn-primary" onclick="calcularRota()">ğŸ“ Calcular Rota</button>
                    <button class="btn btn-success" onclick="encontrarMotoristaProximo()">ğŸš— Encontrar Motorista</button>
                    <div id="resultadoRota" class="rota-info" style="display:none;">
                        <h4>ğŸ“Š Resultado</h4>
                        <div class="rota-detalhe"><span>DistÃ¢ncia:</span><strong id="rotaDistancia">-</strong></div>
                        <div class="rota-detalhe"><span>Tempo:</span><strong id="rotaTempo">-</strong></div>
                        <div class="rota-detalhe"><span>ğŸ’° Valor:</span><strong id="rotaPreco" style="color:#27ae60;font-size:1.3em;">-</strong></div>
                    </div>
                    <div id="motoristaProximo" class="rota-info" style="display:none;margin-top:10px;"><h4>ğŸš— Motorista PrÃ³ximo</h4><div id="motoristaProximoInfo"></div></div>
                </div>
                <div class="panel"><div id="mapaGoogle"></div></div>
            </div>

            <!-- FATURAMENTO -->
            <div id="faturamento" class="page">
                <h2 style="margin-bottom:20px;">ğŸ’° Faturamento</h2>
                <div class="cards">
                    <div class="card green"><h3>Hoje</h3><div class="value">R$ <span id="fatHoje">0</span></div></div>
                    <div class="card blue"><h3>Semana</h3><div class="value">R$ <span id="fatSemana">0</span></div></div>
                    <div class="card purple"><h3>MÃªs</h3><div class="value">R$ <span id="fatMes">0</span></div></div>
                    <div class="card orange"><h3>ComissÃ£o</h3><div class="value">R$ <span id="fatComissao">0</span></div></div>
                </div>
                <div class="panel"><h2>ğŸ“ˆ Faturamento - 30 dias</h2><div class="chart-container"><canvas id="chartFaturamento"></canvas></div></div>
            </div>

            <!-- RANKING -->
            <div id="ranking" class="page">
                <h2 style="margin-bottom:20px;">ğŸ† Ranking</h2>
                <div class="search-bar"><select id="rankingPeriodo" onchange="carregarRanking()"><option value="semana">Semana</option><option value="mes" selected>MÃªs</option><option value="ano">Ano</option></select></div>
                <div class="panel"><div id="rankingLista"></div></div>
            </div>

            <!-- ANTI-FRAUDE -->
            <div id="antifraude" class="page">
                <h2 style="margin-bottom:20px;">ğŸ›¡ï¸ Anti-Fraude</h2>
                <div class="cards">
                    <div class="card red"><h3>CrÃ­ticos</h3><div class="value" id="fraudeCriticos">0</div></div>
                    <div class="card orange"><h3>Altos</h3><div class="value" id="fraudeAltos">0</div></div>
                    <div class="card yellow"><h3>Pendentes</h3><div class="value" id="fraudePendentes">0</div></div>
                    <div class="card green"><h3>Resolvidos</h3><div class="value" id="fraudeResolvidos">0</div></div>
                </div>
                <div class="search-bar">
                    <select id="filtroFraudeStatus"><option value="">Todos</option><option value="pendente">Pendentes</option><option value="resolvido">Resolvidos</option></select>
                    <button class="btn btn-primary" onclick="carregarAntiFraude()">ğŸ”</button>
                </div>
                <div class="panel"><h2>ğŸš¨ Alertas</h2><div id="alertasFraudeLista"></div></div>
            </div>

            <!-- BLACKLIST -->
            <div id="blacklist" class="page">
                <h2 style="margin-bottom:20px;">ğŸš« Blacklist</h2>
                <div class="cards">
                    <div class="card red"><h3>Total</h3><div class="value" id="blacklistTotal">0</div></div>
                    <div class="card orange"><h3>Telefones</h3><div class="value" id="blacklistTelefones">0</div></div>
                    <div class="card purple"><h3>CPFs</h3><div class="value" id="blacklistCPFs">0</div></div>
                </div>
                <button class="btn btn-danger" onclick="abrirModalBlacklist()" style="margin-bottom:20px;">+ Adicionar</button>
                <div class="panel"><table><thead><tr><th>Tipo</th><th>Valor</th><th>Motivo</th><th>Data</th><th>AÃ§Ãµes</th></tr></thead><tbody id="blacklistTable"></tbody></table></div>
            </div>

            <!-- RECLAMAÃ‡Ã•ES -->
            <div id="reclamacoes" class="page">
                <h2 style="margin-bottom:20px;">ğŸ“ ReclamaÃ§Ãµes</h2>
                <div class="cards">
                    <div class="card red"><h3>Pendentes</h3><div class="value" id="recPendentes">0</div></div>
                    <div class="card yellow"><h3>Andamento</h3><div class="value" id="recAndamento">0</div></div>
                    <div class="card green"><h3>Resolvidas</h3><div class="value" id="recResolvidas">0</div></div>
                </div>
                <div class="search-bar">
                    <select id="filtroReclamacao"><option value="">Todas</option><option value="pendente">Pendentes</option><option value="resolvida">Resolvidas</option></select>
                    <button class="btn btn-primary" onclick="carregarReclamacoes()">ğŸ”</button>
                    <button class="btn btn-success" onclick="abrirModalReclamacao()">+ Nova</button>
                </div>
                <div class="panel"><table><thead><tr><th>Data</th><th>Cliente</th><th>Assunto</th><th>Prioridade</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead><tbody id="reclamacoesTable"></tbody></table></div>
            </div>

            <!-- WHATSAPP -->
            <div id="whatsapp" class="page">
                <h2 style="margin-bottom:20px;">ğŸ’¬ WhatsApp</h2>
                <div class="panel"><h2>Status</h2><div id="whatsappStatus"><p><span class="status-indicator offline"></span> Desconectado</p></div></div>
                <div class="panel">
                    <h2>âš™ï¸ Config API</h2>
                    <div class="form-group"><label>URL</label><input type="text" id="whatsappApiUrl"></div>
                    <div class="form-group"><label>API Key</label><input type="password" id="whatsappApiKey"></div>
                    <div class="form-group"><label>InstÃ¢ncia</label><input type="text" id="whatsappInstancia" value="rebeca-taxi"></div>
                    <button class="btn btn-success" onclick="salvarConfigWhatsApp()">ğŸ’¾ Salvar</button>
                </div>
            </div>

            <!-- USUÃRIOS -->
            <div id="usuarios" class="page">
                <h2 style="margin-bottom:20px;">ğŸ‘¤ UsuÃ¡rios Admin</h2>
                <div class="cards">
                    <div class="card blue"><h3>Total</h3><div class="value" id="usrTotal">0</div></div>
                    <div class="card green"><h3>Ativos</h3><div class="value" id="usrAtivos">0</div></div>
                    <div class="card purple"><h3>SessÃµes</h3><div class="value" id="usrSessoes">0</div></div>
                </div>
                <button class="btn btn-success" onclick="abrirModalUsuario()" style="margin-bottom:20px;">+ Novo</button>
                <div class="panel"><table><thead><tr><th>Nome</th><th>Login</th><th>Email</th><th>NÃ­vel</th><th>Ãšltimo Acesso</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead><tbody id="usuariosTable"></tbody></table></div>
            </div>

            <!-- ÃREAS -->
            <div id="areas" class="page">
                <h2 style="margin-bottom:20px;">ğŸ—ºï¸ Ãreas de Cobertura</h2>
                <button class="btn btn-success" onclick="abrirModalArea()" style="margin-bottom:20px;">+ Nova Ãrea</button>
                <div class="panel"><table><thead><tr><th>Nome</th><th>Cidade</th><th>Bairros</th><th>Taxa</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead><tbody id="areasTable"></tbody></table></div>
            </div>

            <!-- PREÃ‡OS -->
            <div id="precos" class="page">
                <h2 style="margin-bottom:20px;">ğŸ’µ PreÃ§os</h2>
                <div class="panel">
                    <h2>Valores Base</h2>
                    <div class="form-row">
                        <div class="form-group"><label>Taxa Base (R$)</label><input type="number" id="taxaBase" step="0.01"></div>
                        <div class="form-group"><label>PreÃ§o/Km (R$)</label><input type="number" id="precoKm" step="0.01"></div>
                        <div class="form-group"><label>Taxa MÃ­nima (R$)</label><input type="number" id="taxaMinima" step="0.01"></div>
                    </div>
                    <button class="btn btn-primary" onclick="salvarConfigPreco()">ğŸ’¾ Salvar</button>
                </div>
            </div>

            <!-- CONFIG -->
            <div id="config" class="page">
                <h2 style="margin-bottom:20px;">âš™ï¸ ConfiguraÃ§Ãµes</h2>
                <div class="panel">
                    <h2>Tempos e Limites</h2>
                    <div class="form-row">
                        <div class="form-group"><label>Tempo Espera (min)</label><input type="number" id="cfgTempoEspera" value="10"></div>
                        <div class="form-group"><label>Tempo Aceite (min)</label><input type="number" id="cfgTempoAceite" value="5"></div>
                        <div class="form-group"><label>Raio Busca (km)</label><input type="number" id="cfgRaioBusca" value="15"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>ComissÃ£o (%)</label><input type="number" id="cfgComissao" value="15"></div>
                        <div class="form-group"><label>AvaliaÃ§Ã£o MÃ­nima</label><input type="number" id="cfgAvaliacaoMin" step="0.1" value="3.0"></div>
                    </div>
                    <button class="btn btn-success" onclick="salvarConfiguracoes()">ğŸ’¾ Salvar</button>
                </div>
            </div>

            <!-- LOGS -->
            <div id="logs" class="page">
                <h2 style="margin-bottom:20px;">ğŸ“œ Logs</h2>
                <div class="cards">
                    <div class="card blue"><h3>Total</h3><div class="value" id="logTotal">0</div></div>
                    <div class="card green"><h3>Hoje</h3><div class="value" id="logHoje">0</div></div>
                    <div class="card red"><h3>Erros</h3><div class="value" id="logErros">0</div></div>
                </div>
                <div class="search-bar">
                    <select id="filtroLogTipo"><option value="">Todos</option><option value="login">Login</option><option value="despacho">Despacho</option><option value="erro">Erro</option></select>
                    <button class="btn btn-primary" onclick="carregarLogs()">ğŸ”</button>
                </div>
                <div class="panel"><div id="logsLista"></div></div>
            </div>
        </main>
    </div>

    <!-- MODAIS -->
    <div class="modal" id="modalMotorista">
        <div class="modal-content">
            <div class="modal-header"><h3>ğŸ“‹ Novo Motorista</h3><button class="modal-close" onclick="fecharModal('modalMotorista')">&times;</button></div>
            <div id="formMotoristaAlert"></div>
            <form id="formMotorista">
                <div class="form-group"><label>Nome *</label><input type="text" id="motNome" required></div>
                <div class="form-row"><div class="form-group"><label>WhatsApp *</label><input type="text" id="motWhatsApp" required></div><div class="form-group"><label>CPF</label><input type="text" id="motCPF"></div></div>
                <div class="form-row"><div class="form-group"><label>CNH *</label><input type="text" id="motCNH" required></div><div class="form-group"><label>Validade</label><input type="date" id="motCNHValidade"></div></div>
                <div class="form-group"><label>EndereÃ§o</label><input type="text" id="motEndereco"></div>
                <hr class="divider">
                <div class="form-row"><div class="form-group"><label>Modelo *</label><input type="text" id="motVeiculoModelo" required></div><div class="form-group"><label>Cor *</label><input type="text" id="motVeiculoCor" required></div></div>
                <div class="form-row"><div class="form-group"><label>Placa *</label><input type="text" id="motVeiculoPlaca" required></div><div class="form-group"><label>Ano</label><input type="number" id="motVeiculoAno"></div></div>
                <button type="submit" class="btn btn-success" style="width:100%;padding:12px;">âœ… Cadastrar</button>
            </form>
            <div id="tokenMotoristaBox" class="token-box" style="display:none;"><h4>ğŸ‰ Cadastrado!</h4><p>Token:</p><code id="tokenGerado"></code><p><strong>Senha:</strong> <span id="senhaGerada"></span></p></div>
        </div>
    </div>

    <div class="modal" id="modalCliente"><div class="modal-content"><div class="modal-header"><h3>Novo Cliente</h3><button class="modal-close" onclick="fecharModal('modalCliente')">&times;</button></div><form id="formCliente"><div class="form-group"><label>Nome</label><input type="text" id="cliNome" required></div><div class="form-group"><label>WhatsApp</label><input type="text" id="cliTelefone" required></div><button type="submit" class="btn btn-success" style="width:100%;">Salvar</button></form></div></div>

    <div class="modal" id="modalReclamacao"><div class="modal-content"><div class="modal-header"><h3>ğŸ“ Nova ReclamaÃ§Ã£o</h3><button class="modal-close" onclick="fecharModal('modalReclamacao')">&times;</button></div><form id="formReclamacao"><div class="form-row"><div class="form-group"><label>Cliente</label><input type="text" id="recClienteNome" required></div><div class="form-group"><label>Telefone</label><input type="text" id="recClienteTel" required></div></div><div class="form-row"><div class="form-group"><label>Tipo</label><select id="recTipo"><option value="motorista">Motorista</option><option value="cobranca">CobranÃ§a</option><option value="outro">Outro</option></select></div><div class="form-group"><label>Prioridade</label><select id="recPrioridade"><option value="baixa">Baixa</option><option value="media">MÃ©dia</option><option value="alta">Alta</option></select></div></div><div class="form-group"><label>Assunto</label><input type="text" id="recAssunto" required></div><div class="form-group"><label>DescriÃ§Ã£o</label><textarea id="recDescricao" rows="3"></textarea></div><button type="submit" class="btn btn-success" style="width:100%;">ğŸ“© Registrar</button></form></div></div>

    <div class="modal" id="modalArea"><div class="modal-content"><div class="modal-header"><h3>ğŸ—ºï¸ Nova Ãrea</h3><button class="modal-close" onclick="fecharModal('modalArea')">&times;</button></div><form id="formArea"><div class="form-group"><label>Nome</label><input type="text" id="areaNome" required></div><div class="form-group"><label>Cidade</label><input type="text" id="areaCidade" required></div><div class="form-group"><label>Bairros</label><input type="text" id="areaBairros" placeholder="Separados por vÃ­rgula"></div><div class="form-group"><label>Taxa Extra</label><input type="number" id="areaTaxa" step="0.01" value="0"></div><button type="submit" class="btn btn-success" style="width:100%;">ğŸ’¾ Salvar</button></form></div></div>

    <div class="modal" id="modalBlacklist"><div class="modal-content"><div class="modal-header"><h3>ğŸš« Blacklist</h3><button class="modal-close" onclick="fecharModal('modalBlacklist')">&times;</button></div><form id="formBlacklist"><div class="form-group"><label>Tipo</label><select id="blTipo"><option value="telefone">Telefone</option><option value="cpf">CPF</option></select></div><div class="form-group"><label>Valor</label><input type="text" id="blValor" required></div><div class="form-group"><label>Motivo</label><textarea id="blMotivo" rows="2" required></textarea></div><button type="submit" class="btn btn-danger" style="width:100%;">ğŸš« Bloquear</button></form></div></div>

    <div class="modal" id="modalUsuario"><div class="modal-content"><div class="modal-header"><h3>ğŸ‘¤ Novo UsuÃ¡rio</h3><button class="modal-close" onclick="fecharModal('modalUsuario')">&times;</button></div><div id="formUsuarioAlert"></div><form id="formUsuario"><div class="form-group"><label>Nome *</label><input type="text" id="usrNome" required></div><div class="form-row"><div class="form-group"><label>Login *</label><input type="text" id="usrLogin" required></div><div class="form-group"><label>Email *</label><input type="email" id="usrEmail" required></div></div><div class="form-row"><div class="form-group"><label>Senha</label><input type="text" id="usrSenha" placeholder="Vazio = 123456"></div><div class="form-group"><label>Telefone</label><input type="text" id="usrTelefone"></div></div><div class="form-group"><label>NÃ­vel *</label><select id="usrNivel"><option value="admin">Administrador</option><option value="gerente">Gerente</option><option value="operador" selected>Operador</option><option value="financeiro">Financeiro</option><option value="atendimento">Atendimento</option></select></div><button type="submit" class="btn btn-success" style="width:100%;padding:12px;">âœ… Criar</button></form><div id="usuarioCriado" class="token-box" style="display:none;"><h4>ğŸ‰ Criado!</h4><p>Login: <strong id="novoUsrLogin"></strong></p><p>Senha: <strong id="novoUsrSenha"></strong></p></div></div></div>

    <div class="modal" id="modalDespachoManual"><div class="modal-content"><div class="modal-header"><h3>ğŸ“¡ Enviar Corrida Manual</h3><button class="modal-close" onclick="fecharModal('modalDespachoManual')">&times;</button></div><div class="form-group"><label>Selecione o Motorista</label><select id="motoristaDespachoManual" style="width:100%;padding:10px;"></select></div><button class="btn btn-success" onclick="enviarCorridaManual()" style="width:100%;margin-top:15px;">ğŸ“¤ Enviar para Motorista</button></div></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
</body>
</html>
